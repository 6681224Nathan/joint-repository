USE lecture08;
select distinct e.empno, hiredate, firstname, lastname 
from           employee e
order by    hiredate asc;

select         deptno, deptname, sum(salary) as totalsalary, count(*) as employees
from           department d, employee e
where        e.workdept = d.deptno
group by   deptno, deptname;

select        deptno, deptname, avg(salary) as MeanSalary
from          department d, employee e
where       e.workdept = d.deptno
group by  deptno, deptname
having      count(*) >= 4;


SELECT MAX(salary) AS highest_salary
FROM employee; #find highest salary from empployee table

SELECT empno, firstname, lastname, salary
FROM employee
WHERE salary = (SELECT MAX(salary) FROM employee); #find PERSONAL DATA of highest salary person

select empno, firstname, lastname, salary
from employee
order by salary desc
limit 1; #alternative way, limit 1 means only the top 1

select         deptno, deptname, max(salary) as maxsalary
from           department d, employee e
where        e.workdept = d.deptno
group by   deptno, deptname; #max salary from each department

select empno, firstname, lastname, salary
from employee, (select         deptno, deptname, max(salary) as maxsalary
from           department d, employee e
where        e.workdept = d.deptno
group by   deptno, deptname) as mx
where salary = maxsalary and workdept=deptno;


